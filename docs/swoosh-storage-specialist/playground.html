<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Playground | Swoosh Storage Specialist</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./assets/buefy.min.css">
  <link rel="stylesheet" href="./assets/materialdesignicons.min.css">
  <link href="./assets/tailwind.min.css" rel="stylesheet">
  <style>
    .footer {
      background: rgb(255, 255, 255);
      background: linear-gradient(0deg, rgba(255, 255, 255, 1) 0%, rgba(250, 250, 250, 1) 50%, rgba(255, 255, 255, 1) 100%);
    }

    h2.title {
      font-weight: normal;
    }

    h2.title > a {
      padding: 0.5rem;
    }

    h2.title > a:hover {
      text-decoration: none;
      background-color: #FABF09;
      color: #E2540C;
    }

    a.download,
    a.download:hover {
      background-color: #FABF09;
      color: #E2540C;
    }

    a.review:hover {
      background-color: rgba(66, 133, 244, 0.039);
      border-color: #d2e3fc;
      color: #1a73e8;
    }

    .snackbar {
      box-shadow: none !important;
      min-width: 300px !important;
    }

    .snackbar > .content {
      width: 270px;
      margin: 0 !important;
    }

    .snackbar > .icon {
      border-radius: 999px;
      background-color: #444;
      width: 40px;
      height: 40px;
    }

    .snackbar > .icon > img {
      width: 24px;
      height: 24px;
    }
  </style>
</head>
<body>
<h1 class="text-center title is-1 mt-12">Web Storage Playground</h1>
<h2 class="text-center title is-5 mt-4">
  <a href="./"
    class="underline">Swoosh Storage Specialist</a>:
  Chrome extension for managing cookie, local storage and session storage
</h2>
<div id="app">
  <section class="section">
    <div class="container">
      <div class="columns">
        <div class="column">
          <b-field>
            <b-radio-button v-model="selectedType" native-value="local" type="is-primary">
              <span>Local Storage</span>
            </b-radio-button>
            <b-radio-button v-model="selectedType" native-value="session" type="is-info">
              <span>Session Storage</span>
            </b-radio-button>
            <b-radio-button v-model="selectedType" native-value="cookie" type="is-warning">
              <span>Cookie</span>
            </b-radio-button>
          </b-field>

        </div>
        <div class="column">
          <div class="text-center">
            <b-button v-if="!isInstalled" class="text-xl download" tag="a"
              href="https://chrome.google.com/webstore/detail/swoosh-storage-specialist/giompennnhheakjcnobejbnjgbbkmdnd"
            >
              Install Chrome Extension: Swoosh Storage Specialist
            </b-button>
            <b-button v-else class="text-xl review" tag="a"
              href="https://chrome.google.com/webstore/detail/swoosh-storage-specialist/giompennnhheakjcnobejbnjgbbkmdnd/reviews/"
            >
              Like Swoosh Storage Specialist? Write a review
            </b-button>
          </div>
        </div>
      </div>

      <div class="columns">
        <div class="column">
          <b-field label="Key" custom-class="is-large" :type="theme">
            <b-input v-model="key" size="is-large" :placeholder="keyPlaceHolder" icon-right="no"></b-input>
          </b-field>
          <b-field label="Value" custom-class="is-large" :type="theme">
            <b-input
              v-model="value"
              :disabled="disabled"
              :has-counter="hasCounter"
              maxlength="âˆž"
              type="textarea"
              :placeholder="valuePlaceHolder"
              icon-right="no"
            ></b-input>
          </b-field>
          <transition name="fade" mode="out-in">
            <template v-if="preset !== 'clock'">
              <b-button :type="theme" size="is-large" @click="save">Save {{displayType}}</b-button>
            </template>
            <template v-else>
              <b-button :type="theme" :disabled="isTimerStarted" size="is-large" @click="setClock">
                Kickoff Clock in {{displayType}}
              </b-button>
              <b-button :disabled="!isTimerStarted" @click="clearClock" type="is-light" size="is-large">
                Clear
              </b-button>
            </template>
          </transition>
        </div>
        <div class="column">
          <div class="field">
            <b-radio v-model="preset" native-value="freestyle" type="is-success">
              Freestyle
            </b-radio>
          </div>
          <div class="field">
            <b-radio v-model="preset" native-value="json-simple" type="is-success">
              Simple JSON
            </b-radio>
          </div>
          <div class="field">
            <b-radio v-model="preset" native-value="json-long" type="is-success">
              Complicated JSON
            </b-radio>
          </div>
          <div class="field">
            <b-radio v-model="preset" native-value="url-encoded-text" type="is-success">
              URL Encoded Text
            </b-radio>
          </div>
          <div class="field">
            <b-radio v-model="preset" native-value="url-encoded-json" type="is-success">
              URL Encoded JSON
            </b-radio>
          </div>
          <div class="field">
            <b-radio v-model="preset" native-value="long" type="is-success">
              Long Text
            </b-radio>
          </div>
          <div class="field">
            <b-radio v-model="preset" native-value="clock" type="is-success">
              Clock (Auto update every second)
            </b-radio>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
<footer class="footer">
  <div class="content has-text-centered">
    &copy; steampunck
  </div>
</footer>
<iframe id="iframe" style="display: none"></iframe>
<script src="./assets/vue.min.js"></script>
<script src="./assets/buefy.min.js"></script>
<script>
  window.playground = new Vue({
    el: '#app',
    data: {
      key: "",
      value: "",
      isInstalled: false,
      hasCounter: false,
      disabled: false,
      message: 'Playground',
      selectedType: 'local',
      preset: 'freestyle',
      localTimer: null,
      sessionTimer: null,
      cookieTimer: null,
      sampleTimer: null
    },
    computed: {
      displayType: function () {
        switch (this.selectedType) {
          case "session":
            return "SessionStorage";
          case "local":
            return "LocalStorage";
          case "cookie":
            return "Cookie";
        }
      },
      theme: function () {
        switch (this.selectedType) {
          case "local":
            return "is-primary";
          case "session":
            return "is-info";
          case "cookie":
            return "is-warning";
        }
      },
      valuePlaceHolder: function () {
        return this.displayType + ' Value';
      },
      keyPlaceHolder: function () {
        return this.displayType + ' Key';
      },
      isTimerStarted: function () {
        if (this.selectedType === "local") return this.localTimer !== null;
        if (this.selectedType === "session") return this.sessionTimer !== null;
        if (this.selectedType === "cookie") return this.cookieTimer !== null;
      }
    },
    watch: {
      preset: function (val) {
        switch (val) {
          case "freestyle":
            this.key = "";
            this.value = "";
            this.hasCounter = false;
            this.disabled = false;
            if (this.sampleTimer) {
              this.stopClock();
            }
            break;
          case "clock":
            this.key = "clock";
            this.hasCounter = false;
            this.disabled = true;
            this.startClock();
            break;
          case "json-simple":
            this.key = "simple-json";
            this.value = '{"key":"value", "bool": true, "num": 1, "arr":[]}';
            this.hasCounter = false;
            this.disabled = false;
            if (this.sampleTimer) {
              this.stopClock();
            }
            break;
          case "json-long":
            this.key = "complicated-json";
            this.value = `{
   "web-app":{
      "servlet":[
         {
            "servlet-name":"cofaxCDS",
            "servlet-class":"org.cofax.cds.CDSServlet",
            "init-param":{
               "configGlossary:installationAt":"Philadelphia, PA",
               "configGlossary:adminEmail":"ksm@pobox.com",
               "configGlossary:poweredBy":"Cofax",
               "configGlossary:poweredByIcon":"/images/cofax.gif",
               "configGlossary:staticPath":"/content/static",
               "templateProcessorClass":"org.cofax.WysiwygTemplate",
               "templateLoaderClass":"org.cofax.FilesTemplateLoader",
               "templatePath":"templates",
               "templateOverridePath":"",
               "defaultListTemplate":"listTemplate.htm",
               "defaultFileTemplate":"articleTemplate.htm",
               "useJSP":false,
               "jspListTemplate":"listTemplate.jsp",
               "jspFileTemplate":"articleTemplate.jsp",
               "cachePackageTagsTrack":200,
               "cachePackageTagsStore":200,
               "cachePackageTagsRefresh":60,
               "cacheTemplatesTrack":100,
               "cacheTemplatesStore":50,
               "cacheTemplatesRefresh":15,
               "cachePagesTrack":200,
               "cachePagesStore":100,
               "cachePagesRefresh":10,
               "cachePagesDirtyRead":10,
               "searchEngineListTemplate":"forSearchEnginesList.htm",
               "searchEngineFileTemplate":"forSearchEngines.htm",
               "searchEngineRobotsDb":"WEB-INF/robots.db",
               "useDataStore":true,
               "dataStoreClass":"org.cofax.SqlDataStore",
               "redirectionClass":"org.cofax.SqlRedirection",
               "dataStoreName":"cofax",
               "dataStoreDriver":"com.microsoft.jdbc.sqlserver.SQLServerDriver",
               "dataStoreUrl":"jdbc:microsoft:sqlserver://LOCALHOST:1433;DatabaseName=goon",
               "dataStoreUser":"sa",
               "dataStorePassword":"dataStoreTestQuery",
               "dataStoreTestQuery":"SET NOCOUNT ON;select test='test';",
               "dataStoreLogFile":"/usr/local/tomcat/logs/datastore.log",
               "dataStoreInitConns":10,
               "dataStoreMaxConns":100,
               "dataStoreConnUsageLimit":100,
               "dataStoreLogLevel":"debug",
               "maxUrlLength":500
            }
         },
         {
            "servlet-name":"cofaxEmail",
            "servlet-class":"org.cofax.cds.EmailServlet",
            "init-param":{
               "mailHost":"mail1",
               "mailHostOverride":"mail2"
            }
         },
         {
            "servlet-name":"cofaxAdmin",
            "servlet-class":"org.cofax.cds.AdminServlet"
         },
         {
            "servlet-name":"fileServlet",
            "servlet-class":"org.cofax.cds.FileServlet"
         },
         {
            "servlet-name":"cofaxTools",
            "servlet-class":"org.cofax.cms.CofaxToolsServlet",
            "init-param":{
               "templatePath":"toolstemplates/",
               "log":1,
               "logLocation":"/usr/local/tomcat/logs/CofaxTools.log",
               "logMaxSize":"",
               "dataLog":1,
               "dataLogLocation":"/usr/local/tomcat/logs/dataLog.log",
               "dataLogMaxSize":"",
               "removePageCache":"/content/admin/remove?cache=pages&id=",
               "removeTemplateCache":"/content/admin/remove?cache=templates&id=",
               "fileTransferFolder":"/usr/local/tomcat/webapps/content/fileTransferFolder",
               "lookInContext":1,
               "adminGroupID":4,
               "betaServer":true
            }
         }
      ],
      "servlet-mapping":{
         "cofaxCDS":"/",
         "cofaxEmail":"/cofaxutil/aemail/*",
         "cofaxAdmin":"/admin/*",
         "fileServlet":"/static/*",
         "cofaxTools":"/tools/*"
      },
      "taglib":{
         "taglib-uri":"cofax.tld",
         "taglib-location":"/WEB-INF/tlds/cofax.tld"
      }
   }
}`;
            this.hasCounter = false;
            this.disabled = false;
            if (this.sampleTimer) {
              this.stopClock();
            }
            break;
          case "long":
            this.disabled = false;
            this.key = "not_super_long_key";
            this.value = "But Super Long Value: Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean maximus urna eget tristique consectetur. Aenean fermentum ultrices nisl vitae ultrices. Etiam sed mauris ante. Aliquam vestibulum sem in lorem feugiat, a bibendum est interdum. Nullam tempus risus ut dolor ultrices, eu elementum quam convallis. Suspendisse potenti. Integer faucibus cursus porta. Integer mi ipsum, sollicitudin ac ante id, ornare consectetur elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean maximus urna eget tristique consectetur. Aenean fermentum ultrices nisl vitae ultrices. Etiam sed mauris ante. Aliquam vestibulum sem in lorem feugiat, a bibendum est interdum. Nullam tempus risus ut dolor ultrices, eu elementum quam convallis. Suspendisse potenti. Integer faucibus cursus porta. Integer mi ipsum, sollicitudin ac ante id, ornare consectetur elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean maximus urna eget tristique consectetur. Aenean fermentum ultrices nisl vitae ultrices. Etiam sed mauris ante. Aliquam vestibulum sem in lorem feugiat, a bibendum est interdum. Nullam tempus risus ut dolor ultrices, eu elementum quam convallis. Suspendisse potenti. Integer faucibus cursus porta. Integer mi ipsum, sollicitudin ac ante id, ornare consectetur elit. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean maximus urna eget tristique consectetur. Aenean fermentum ultrices nisl vitae ultrices. Etiam sed mauris ante. Aliquam vestibulum sem in lorem feugiat, a bibendum est interdum. Nullam tempus risus ut dolor ultrices, eu elementum quam convallis. Suspendisse potenti. Integer faucibus cursus porta. Integer mi ipsum, sollicitudin ac ante id, ornare consectetur elit. ";
            this.hasCounter = true;
            if (this.sampleTimer) {
              this.stopClock();
            }
            break;
          case "url-encoded-text":
            this.disabled = false;
            this.key = "url_encoded_text";
            this.value = "There're%20100%25%20java%2Fscript%20%26%20HTML%20(not%20%225%22)%2C%20which%20cost%20%249.9%20%2B%201%20%3D%20%2410.9%20%40%20line%20%234%3F!";
            this.hasCounter = false;
            if (this.sampleTimer) {
              this.stopClock();
            }
            break;
          case "url-encoded-json":
            this.disabled = false;
            this.key = "url_encoded_json";
            this.value = "%7B%22percentage%22%3A%22100%25%22%2C%22arr%22%3A%5B123%2C%7B%7D%2C%22B%26W%22%5D%2C%22regex%22%3Anull%7D";
            this.hasCounter = false;
            if (this.sampleTimer) {
              this.stopClock();
            }
            break;
        }
      }
    },
    methods: {
      save: function () {
        if (this.key) {
          switch (this.selectedType) {
            case "local":
              localStorage.setItem(this.key, this.value);
              break;
            case "session":
              sessionStorage.setItem(this.key, this.value);
              break;
            case "cookie":
              document.cookie = this.key + "=" + (this.value || "") + "; path=/";
              break;
          }
          this.openSnackbar();
        }
      },
      installed: function () {
        this.isInstalled = true;
      },
      startClock: function () {
        this.sampleTimer = setInterval(() => {
          const now = new Date();
          this.value = `${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;
        });
      },
      stopClock: function () {
        clearInterval(this.sampleTimer);
        this.sampleTimer = null;
      },
      setClock: function () {
        if (this.selectedType === "local") {
          this.localTimer = setInterval(() => {
            const now = new Date();
            const clock = `${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;
            localStorage.setItem(this.key, clock);
          }, 1000);
        }
        if (this.selectedType === "session") {
          this.sessionTimer = setInterval(() => {
            const now = new Date();
            const clock = `${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;
            sessionStorage.setItem(this.key, clock);
          }, 1000);
        }
        if (this.selectedType === "cookie") {
          this.cookieTimer = setInterval(() => {
            const now = new Date();
            const clock = `${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;
            document.cookie = this.key + "=" + (clock || "") + "; path=/";
          }, 1000);
        }
        this.openSnackbar();
      },
      clearClock: function () {
        if (this.selectedType === "local") {
          clearInterval(this.localTimer);
          this.localTimer = null;
        }
        if (this.selectedType === "session") {
          clearInterval(this.sessionTimer);
          this.sessionTimer = null;
        }
        if (this.selectedType === "cookie") {
          clearInterval(this.cookieTimer);
          this.cookieTimer = null;
        }
      },
      openSnackbar: function () {
        if (!this.isInstalled) {
          return;
        }
        this.$buefy.snackbar.open({
          message: `
<div class="snackbar">
  <span class="content text">Open Swoosh Storage Specialist and see what changed</span>
  <span class="icon"><img width="32" height="32" src="assets/icon.png"/></span>
</div>
`,
          type: 'is-success',
          position: 'is-top-right',
          indefinite: false,
          duration: 5000,
          onAction: () => {
          }
        })
      }
    }
  });

  setTimeout(function () {
    const id = location.hostname === "localhost" ? "inlhjjhkifegoiohognmfogbcjnnknpp" : "giompennnhheakjcnobejbnjgbbkmdnd";
    document.getElementById("iframe").src = `chrome-extension://${id}/installed.html`;
  }, 500);
</script>
</body>
</html>
